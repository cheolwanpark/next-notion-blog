<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prism.js Python Syntax Highlighting Test</title>
    <!-- Prism.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-title {
            color: #333;
            margin-bottom: 15px;
        }
        pre {
            background: #f5f5f5;
            border-radius: 6px;
            overflow-x: auto;
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>Prism.js Python Syntax Highlighting Test</h1>
    
    <div class="test-section">
        <h2 class="test-title">Test 1: Python Code with Agent Toolkit (Your Example)</h2>
        <pre class="line-numbers"><code class="language-python">from claude_agent_toolkit import Agent

calculator_tool = CalculatorTool()

agent = Agent(
    system_prompt="수학 계산을 도와주는 친절한 어시스턴트입니다.",
    tools=[calculator_tool]
)

result = await agent.run("10 더하기 5는 몇인가요?")</code></pre>
    </div>

    <div class="test-section">
        <h2 class="test-title">Test 2: Standard Python Code</h2>
        <pre class="line-numbers"><code class="language-python">import asyncio
import json
from typing import Dict, List, Optional

class DataProcessor:
    def __init__(self, config: Dict[str, any]):
        self.config = config
        self.results = []
    
    async def process_data(self, data: List[Dict]) -> Optional[Dict]:
        """Process data asynchronously with error handling."""
        try:
            for item in data:
                if item.get('status') == 'active':
                    processed = self._transform_item(item)
                    self.results.append(processed)
            
            return {
                'status': 'success',
                'count': len(self.results),
                'data': self.results
            }
        except Exception as e:
            print(f"Error processing data: {e}")
            return None
    
    def _transform_item(self, item: Dict) -> Dict:
        return {
            'id': item['id'],
            'name': item['name'].strip().title(),
            'value': float(item.get('value', 0)),
            'timestamp': item.get('created_at')
        }

# Usage example
async def main():
    processor = DataProcessor({'debug': True})
    sample_data = [
        {'id': 1, 'name': 'test item', 'value': '123.45', 'status': 'active'},
        {'id': 2, 'name': 'another item', 'value': '67.89', 'status': 'inactive'}
    ]
    
    result = await processor.process_data(sample_data)
    print(json.dumps(result, indent=2))

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
    </div>

    <div class="test-section">
        <h2 class="test-title">Test Status</h2>
        <div id="test-status" class="status warning">Testing in progress...</div>
        <div id="grammar-status"></div>
        <div id="highlight-status"></div>
    </div>

    <!-- Prism.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

    <script>
        // Test script to verify Prism.js functionality
        document.addEventListener('DOMContentLoaded', function() {
            const testStatus = document.getElementById('test-status');
            const grammarStatus = document.getElementById('grammar-status');
            const highlightStatus = document.getElementById('highlight-status');
            
            // Test 1: Check if Python grammar is loaded
            setTimeout(() => {
                const pythonGrammar = Prism.languages.python;
                if (pythonGrammar) {
                    grammarStatus.innerHTML = '<div class="status success">✅ Python grammar loaded successfully</div>';
                } else {
                    grammarStatus.innerHTML = '<div class="status error">❌ Python grammar not loaded</div>';
                }
                
                // Test 2: Check if code blocks are highlighted
                const tokens = document.querySelectorAll('.token');
                if (tokens.length > 0) {
                    highlightStatus.innerHTML = `<div class="status success">✅ Syntax highlighting applied (${tokens.length} tokens found)</div>`;
                    testStatus.className = 'status success';
                    testStatus.textContent = '✅ All tests passed - Python syntax highlighting is working!';
                } else {
                    highlightStatus.innerHTML = '<div class="status error">❌ No syntax highlighting tokens found</div>';
                    testStatus.className = 'status error';
                    testStatus.textContent = '❌ Tests failed - Syntax highlighting not working';
                }
            }, 1000);
        });
    </script>
</body>
</html>